function PsPostBox(){this.$textarea=null,this.$access=null,this.$charcount=null,this.$save_button=null,this.$cancel_button=null,this.$activity_stream=null,this.text_length=4e3,this.media_found=!1}PsPostBox.prototype.init=function(){this.$textarea=jQuery("#ps-postbox"),this.$access=jQuery("#postbox_acc"),this.$charcount=jQuery("#post-charcount"),this.$save_button=jQuery("#postbox-post"),this.$cancel_button=jQuery("#postbox-cancel"),this.$activity_stream=jQuery("#ps-activitystream"),"undefinded"!=typeof peepsodata.postsize&&(this.text_length=peepsodata.postsize),jQuery("#post-charcount").html(this.text_length+""),this.$textarea.autosize().on("focus",function(a){postbox.on_focus()}).on("keyup",function(a){postbox.on_change()}),this.$save_button.click(this.save_post),this.$cancel_button.click(postbox.cancel_post),jQuery("#postbox-privacy li a").click(function(a){var b=jQuery(a.target).closest("a"),c=jQuery("#privacy-tab"),d=jQuery("#postbox_acc"),e=c.find("a"),f=b.closest("#postbox-privacy");c.find("i").attr("class",b.find("i").attr("class")),d.val(b.attr("data-option-value")),e.html(b.html()),f.hide()}),jQuery("nav.ps-postbox-tab ul li a").click(postbox.clear_tabs)},PsPostBox.prototype.clear_tabs=function(){ps_observer.apply_filters("postbox_clear_tabs",null)},PsPostBox.prototype.privacy=function(){jQuery("#postbox-privacy").show()},PsPostBox.prototype.save_post=function(){var a={content:postbox.$textarea.val(),id:peepsodata.currentuserid,uid:peepsodata.userid,acc:postbox.$access.val(),type:"activity"};a=ps_observer.apply_filters("postbox_req",a),jQuery(".ps-postbox-loading").show(),$PeepSo.postJson("postbox.post",a,function(a){if(a.success){postbox.$activity_stream.prepend(a.data.html),postbox.cancel_post();var b=a.data.post_id;jQuery("#peepso-wrap .ps-js-activity--"+b+" .dropdown-toggle").click(dropdown_toggle_click).on("mouseenter",dropdown_toggle_mouseenter),jQuery("#peepso-wrap .ps-js-activity--"+b+" .dropdown-menu a").click(dropdown_toggle_a_click)}jQuery(".ps-postbox-loading").hide(),ps_observer.apply_filters("postbox_post_saved",null)})},PsPostBox.prototype.cancel_post=function(){postbox.$textarea.val(""),postbox.on_change(),ps_observer.apply_filters("postbox_post_saved",null)},PsPostBox.prototype.on_focus=function(){},PsPostBox.prototype.on_change=function(){var a=this.$textarea.val(),b=a.length;b=this.text_length-b,this.$charcount.html(b+""),b>=30?this.$charcount.removeClass("alert-info").removeClass("alert-error"):30>b?this.$charcount.addClass("alert-info"):20>b&&this.charcount.removeClass("alert-info").addClass("alert-error"),b<this.text_length?this.$save_button.show():this.$save_button.hide()};var postbox=new PsPostBox;jQuery(document).ready(function(){postbox.init()});